<!doctype html>
<html class="mo-bile">

	<head>
		<meta charset="UTF-8">
		<link rel="stylesheet" href="styles/base.css" media="screen"/>
		<link rel="stylesheet" href="styles/broen.css" media="screen"/>
		<link rel="stylesheet" href="styles/icomoon.css">
		<link type="text/css" href="styles/zdfplayer-1.4.2356.min.css" rel="stylesheet" />	
	</head>

	<body>
		<div id="broen-gallery-container"> </div>
	
		<script src="js/libs/mootools-core-1.4.5-full-nocompat.js"></script>
		<script type="text/javascript" src="js/libs/d3.min.js"></script>
		<script type="text/javascript" src="js/libs/require.js"></script>
		<script type="text/javascript" src="js/libs/require.config.js"></script>
		<script type="text/javascript" src="js/libs/mootools-router.js"></script>
		<script type="text/javascript" src="js/libs/swipe.js"></script>
		<script type="text/javascript" src="js/libs/dr-widget-swipe-carousel.js"></script>
		<script type="text/javascript" src="js/broen.js"></script>
	
		<script type="text/javascript">

			var myRequest = new Request({
			    url: 'episode',
			    method: "GET",
			    onSuccess: function(responseText, responseXML){
			        var e = responseText.toInt();
			        if (e=="NaN") e = 0;

			        new DR.BroenGallery.App('broen-gallery-container',e);
					console.log('Geladen f√ºr Episode '+e);
			    }
			});			 
			myRequest.send();
			
		</script>
		<script type="text/javascript" src="js/libs/zdfplayer-with-all-1.4.2356.min.js"></script>

		<script>

			var player = null;


			function createasset(url){

				var formitaeten = [			
					new zdfplayer.media.Formitaet({
						baseType : 'h264_aac_mp4_http_na_na',
						quality : 'veryhigh',
						url : url,
						videoBitrate : 1680000,
						audioBitrate : 48000
					})
				]

				var asset = new zdfplayer.media.ManualAsset({
	                type : 'vod', // default or 'live'
					title : 'Lorem',
					description : 'Ipsum',
					airTime : '01.10.2012 12:00',
					timeToLive : '08.06.2013 19:59',   
					channelTitle : 'ZDF DZF FZD',
					vcmsURL : '',
					cuepoints : "",
					formitaeten : formitaeten,
					teaserImages : "",
					family : '',
					count : ''
				});			
				return asset;
			}

			function playvideo(el){

				var url = el.getAttribute("video-url");
				var elid = el.id;

				// register Listener for player ready event
				// player.addEventListener(zdfplayer.Player.READY, function(event)
				// {
				// 	console.log('Hello I am your player. I am ready now');
				// 	setTimeout( function(){
				// 		console.log("autoplay");
				// 		player.play();
				// 		},3000)
				// })

				if (!jQuery( "#myvideo" ).length>0){

					// create player instance via PlayerFactory
					player = zdfplayer.PlayerFactory.instanciate(
					{
						id: 'zdfplayer1',
						configurationUrl: 'js/libs/configuration_full_feature.xml',
						mediaAsset : createasset(url),
						preloaderImageUrl : "img/spinner.gif",
						settings:
						{
							source : 'manual',
							autoPlay : true,
							embedTypes : 'html5',
							scaleMode : 'letterbox',
							//width : 720,
							width : 734,
							// height : 416,
							height : 416,
							tracking : { source : 'manual'},
		                    initialQuality: 'high'

						}
					});

					jQuery( "<div id='myvideo'></div>" ).insertBefore("#"+elid);
					player.embed("myvideo");			
					
				} else
				{
					//display
					jQuery( "#myvideo" ).insertBefore("#"+elid);				
	        		player.changeAsset(createasset(url));
	        		player.play();
	        	}
				return false;
	    	}
		</script>
		
	</body>


	
</html>